<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>infiniterelic</title>
<style>
    :root {
        --bg: #ffffff; --panel: #f8f9fa; --border: #dee2e6;
        --primary: #007bff; --text: #212529; --sub: #6c757d;
        --accent: #dc3545; --gold: #d39e00; --hp: #28a745;
    }
    body { background: var(--bg); color: var(--text); font-family: sans-serif; margin: 0; overflow: hidden; height: 100vh; display: flex; flex-direction: column; }
    #header { background: var(--panel); padding: 10px; border-bottom: 2px solid var(--border); flex-shrink: 0; }
    .nav { display: flex; background: var(--panel); border-bottom: 1px solid var(--border); flex-shrink: 0; overflow-x: auto; }
    .nav button { flex: 1; min-width: 80px; padding: 12px 0; border: none; background: none; color: var(--sub); font-weight: bold; font-size: 0.75em; cursor: pointer; }
    .nav button.active { color: var(--primary); border-bottom: 3px solid var(--primary); background: #fff; }
    #content { flex-grow: 1; overflow: hidden; position: relative; background: #fff; }
    .tab { display: none; padding: 10px; height: 100%; box-sizing: border-box; overflow-y: auto; }
    .tab.active { display: block; }
    .bar-container { margin-bottom: 4px; }
    .bar-label { display: flex; justify-content: space-between; font-size: 0.75em; font-weight: bold; }
    .bar { height: 8px; background: #eee; border-radius: 4px; overflow: hidden; }
    .fill { height: 100%; transition: width 0.1s ease; }
    #bosshp { background: linear-gradient(90deg, #ffc107, #dc3545); }
    #playerhp { background: var(--hp); }
    #exp-bar { background: var(--primary); }
    .stats-summary { margin-top: 6px; background: rgba(0,0,0,0.03); padding: 8px; border-radius: 4px; font-size: 0.8em; }
    .card-cell { background: #fff; border: 1px solid var(--border); padding: 12px; border-radius: 8px; margin-bottom: 10px; box-shadow: 0 1px 3px rgba(0,0,0,0.1); }
    .skill-list { display: grid; grid-template-columns: 1fr 1fr; gap: 4px; margin-top: 8px; }
    .skill-item { font-size: 0.52em; padding: 4px; border-radius: 4px; background: #f1f3f5; border-left: 2px solid var(--border); color: #888; line-height: 1.2; }
    .skill-unlocked { border-left-color: var(--primary); background: #e7f5ff; color: #000; font-weight: bold; }
    .btn-attack { width: 100%; padding: 20px; background: var(--primary); color: #fff; font-size: 1.1em; font-weight: bold; border: none; border-radius: 8px; cursor: pointer; margin-bottom: 10px; }
    #log { font-size: 0.75em; background: #fdfdfd; padding: 8px; border: 1px solid var(--border); border-radius: 6px; height: 150px; overflow-y: auto; }
    .status-item { display: flex; justify-content: space-between; padding: 8px 0; border-bottom: 1px solid #eee; font-size: 0.9em; }
    .relic-effect { font-size: 0.75em; color: var(--hp); font-weight: bold; margin-top: 4px; }
</style>
</head>
<body>
<div id="header">
    <div class="bar-container"><div class="bar-label"><span>È≠îÁ•û</span><span id="bosshp-text">100%</span></div><div class="bar"><div id="bosshp" class="fill"></div></div></div>
    <div class="bar-container"><div class="bar-label"><span>HP</span><span id="playerhp-text">0/0</span></div><div class="bar"><div id="playerhp" class="fill"></div></div></div>
    <div class="bar-container"><div class="bar-label"><span id="p-lv-text">Lv.1</span><span id="exp-text">0%</span></div><div class="bar"><div id="exp-bar" class="fill"></div></div></div>
    <div class="stats-summary"><div style="display:flex; justify-content:space-between;"><span>ATK:</span><span id="sum-atk">0</span></div></div>
</div>
<div class="nav">
    <button onclick="showTab('battle', this)" class="active">Ë®é‰ºê</button>
    <button onclick="showTab('status', this)">ËÉΩÂäõ</button>
    <button onclick="showTab('power', this)">Ê®©ËÉΩ</button>
    <button onclick="showTab('relic', this)">ÈÅ∫Áâ©</button>
</div>
<div id="content">
    <div id="battle" class="tab active"><button class="btn-attack" id="attackBtn">È≠îÁ•û„Å´ÊîªÊíÉ</button><div id="log"></div></div>
    <div id="status" class="tab"><div id="statusList"></div></div>
    <div id="power" class="tab"><div id="powerList"></div></div>
    <div id="relic" class="tab"><div id="relicList"></div></div>
</div>
<script>
const BOSS_MAX_HP = 1e20;
const SAVE_KEY = "MAJIN_DPS_V8_RESET";
const RELIC_GRADES = ["Ê¨†Áâá", "ÂøÉÂæó", "Ë®òÊÜ∂", "Ê•µÊÑè", "È≠Ç", "Á•ûÂüü", "Ê∑±Ê∑µ", "ËôöÁÑ°", "ÁúüÁêÜ", "Ë∂ÖË∂ä"];
const STEPS = [10, 50, 150, 300, 500, 800, 1200, 2000, 3500, 5000];
const POWER_NAMES = ["Ââ£Á•û„ÅÆÊÆãÁÅ´","‰∏çÊªÖ„ÅÆÂÆàË≠∑ËÄÖ","È≠îÂ∞éÁéã„ÅÆÈÅ∫Âøó","Ë¶áÁéã„ÅÆÊÆãÂÖâ","Áµ∂ÂΩ±„ÅÆÊÆãÂΩ±","‰øÆÁæÖ„ÅÆÂíÜÂìÆ","ÁúüÁêÜ„ÅÆÊÆãÊªì","Á•ûË®ó„ÅÆÊÆãÈüø","ËôöÁÑ°„ÅÆÊ∑±Ê∑µ","Ê©üÂ∑•„ÅÆÂøÉËáì"];

const SKILL_MASTER = {
    "Ââ£Á•û„ÅÆÊÆãÁÅ´": [
        {n:"‰∏Ä„ÅÆÂ§™ÂàÄ", e:"ATK 5ÂÄç"}, {n:"ÁáïËøî„Åó", e:"ËøΩÊíÉÁéá+30%"}, {n:"ÂøÉÁúº", e:"„ÇØ„É™Áéá+40%"}, {n:"ÁÑ°ÊÉ≥", e:"„ÇØ„É™Â®ÅÂäõ10ÂÄç"}, {n:"Â§©Êñ≠", e:"1000ÂÄçÊíÉ"},
        {n:"Á•ûÈÄü", e:"ÈÄüÂ∫¶2ÂÄç"}, {n:"ÊµÅÊòü", e:"„Éí„ÉÉ„Éà+5"}, {n:"ÁúüÁ©∫", e:"ATK 20ÂÄç"}, {n:"Ê•µ„Éª‰∏ÄÊñáÂ≠ó", e:"„ÇØ„É™100%"}, {n:"Ââ£Á•ûÈôçËá®", e:"„ÉÄ„É°1‰∏áÂÄç"}
    ],
    "‰∏çÊªÖ„ÅÆÂÆàË≠∑ËÄÖ": [
        {n:"‰∏çÂ±à", e:"ÂÜçËµ∑+5000"}, {n:"ÂÜçÁîü„ÅÆÊ•î", e:"HPÂõûÂæ©10%"}, {n:"ÈÄÜÂ¢É„ÅÆÁêÜ", e:"HPÊ∏õ„ÅßATKÂÄç"}, {n:"‰∏çÊ≠ª„ÅÆÈ≠Ç", e:"Âç≥Ê≠ªËÄêÊÄß"}, {n:"ÂÆàË≠∑Á•û„ÅÆË™á„Çä", e:"ATK 10ÂÄç"},
        {n:"ÈáëÂâõ„ÅÆ‰Ωì", e:"HP 100ÂÄç"}, {n:"ÈâÑÂ£Å„ÅÆÊßã„Åà", e:"Ë¢´„ÉÄ„É°ÊøÄÊ∏õ"}, {n:"Â†±Âæ©„ÅÆÊ£ò", e:"ÂèçÂ∞Ñ100ÂÄç"}, {n:"Áµ∂Êúõ„Å∏„ÅÆÊäó„ÅÑ", e:"ÂÖ®Ë£úÊ≠£2ÂÄç"}, {n:"‰∏çÊªÖ„ÅÆËÅñÂüü", e:"‰∏çÊ≠ªË∫´Âåñ"}
    ],
    "È≠îÂ∞éÁéã„ÅÆÈÅ∫Âøó": [
        {n:"È≠îÂäõÂ∞éÁ∑ö", e:"ÈÅ∫Áâ©ATK+10%"}, {n:"Ë°ìÂºèÂ±ïÈñã", e:"ATK 3ÂÄç"}, {n:"Ë©†Âî±Á†¥Ê£Ñ", e:"ÈÄüÂ∫¶1.5ÂÄç"}, {n:"Â§öÈáçÊßãÁØâ", e:"„Éí„ÉÉ„Éà+2"}, {n:"Ê∑±Ê∑µ„ÅÆÁü•ÊÅµ", e:"EXP 2ÂÄç"},
        {n:"È≠îÂ∞é„ÅÆÊ•µËá¥", e:"ATK 30ÂÄç"}, {n:"ÂÖÉÁ¥†ÁàÜÁô∫", e:"ÁØÑÂõ≤„ÉÄ„É°"}, {n:"ÁúüÁêÜ„ÅÆÈñÄ", e:"ÂÖ®„Çπ„Ç≠Âº∑Âåñ"}, {n:"Ë≥¢ËÄÖ„ÅÆÁü≥", e:"ÈÅ∫Áâ©Êï∞ATK"}, {n:"È≠îÂ∞éÁéã„ÅÆÂÜçËá®", e:"È≠îÂäõÁÑ°Èôê"}
    ],
    "Ë¶áÁéã„ÅÆÊÆãÂÖâ": [
        {n:"Â®ÅÂúß", e:"ÊïµÂº±‰ΩìÂåñ"}, {n:"Áéã„ÅÆÈÄ≤Ëªç", e:"ATK 8ÂÄç"}, {n:"Âá±Êóã„ÅÆÈ¨®", e:"EXP 5ÂÄç"}, {n:"Áµ±Áéá„ÅÆÊâç", e:"ÈÅ∫Áâ©ATK+50%"}, {n:"Ë¶áÁéã„ÅÆÁõæ", e:"HP 10ÂÄç"},
        {n:"ÈªÑÈáë„ÅÆÂ§úÊòé„Åë", e:"ÂÖ®„ÉÄ„É°50ÂÄç"}, {n:"Â§©„Çí„ÇÇÁµ±„Åπ„Çã", e:"„Éí„ÉÉ„Éà+10"}, {n:"‰∏çÊäú„ÅÆÂüéÂ°û", e:"ÂÆåÂÖ®Èò≤Âæ°"}, {n:"Áµ∂ÂØæÁéãÊîø", e:"ATK 500ÂÄç"}, {n:"Ëá≥È´ò„ÅÆÂæ°Â∫ß", e:"Ë¶áÈÅìÊ•µËá¥"}
    ],
    "Áµ∂ÂΩ±„ÅÆÊÆãÂΩ±": [
        {n:"ÊÄ•ÊâÄÁ©ø„Å°", e:"„ÇØ„É™Â®ÅÂäõ5ÂÄç"}, {n:"ÂΩ±Ëµ∞„Çä", e:"ÂõûÈÅø+50%"}, {n:"Ê≠ª„ÅÆÂàªÂç∞", e:"Ââ≤Âêà„ÉÄ„É°"}, {n:"ËôöÂÉè„ÅÆËàû", e:"ÈÄüÂ∫¶5ÂÄç"}, {n:"ÊöóÊÆ∫ËÄÖ„ÅÆË™á„Çä", e:"ATK 15ÂÄç"},
        {n:"ÂàπÈÇ£„ÅÆÈñÉ„Åç", e:"Âç≥Ê≠ª‰ªò‰∏é"}, {n:"Èóá„Å´Ê∫∂„Åë„Çã", e:"ÁÑ°ÊïµÂåñ"}, {n:"Áµ∂ÂΩ±„ÅÆÈÄ£ÊíÉ", e:"„Éí„ÉÉ„Éà+20"}, {n:"È≠Ç„ÅÆÂèéÁ©´", e:"ÊíÉÁ†¥ATKÂ¢ó"}, {n:"ËôöÁÑ°„ÅÆÁµÇÁÑâ", e:"‰∏ÄÊíÉÂøÖÊÆ∫"}
    ],
    "‰øÆÁæÖ„ÅÆÂíÜÂìÆ": [
        {n:"ÁãÇ‰π±", e:"ATK 12ÂÄç"}, {n:"Ë°ÄÊà¶„ÅÆÂ•ë„Çä", e:"HPÊ∂àË≤ªATKÂ¢ó"}, {n:"Â±†ÊÆ∫„ÅÆÁâô", e:"„ÇØ„É™Áéá+20%"}, {n:"ÈóòÁ•û„ÅÆË°Ä", e:"ÂÜçËµ∑ATK+10%"}, {n:"‰øÆÁæÖ„ÅÆÈÅì", e:"ÈÄüÂ∫¶3ÂÄç"},
        {n:"È£Ω„Åè„Å™„ÅçÈóò‰∫â", e:"ÈÄ£ÊíÉÊï∞Â¢óÂä†"}, {n:"ÊÜ§ÊÄí„ÅÆÊ≥¢Âãï", e:"ÂÖ®‰Ωì„ÉÄ„É°"}, {n:"È¨ºÁ•û„ÅÆÈÄ£ÊíÉ", e:"„Éí„ÉÉ„Éà+15"}, {n:"ÂëΩ„ÇíÂñ∞„Çâ„ÅÜ", e:"Âê∏Âèé10%"}, {n:"ÂÜ•Â∫ú„ÅÆÁéã", e:"‰øÆÁæÖË¶öÈÜí"}
    ],
    "ÁúüÁêÜ„ÅÆÊÆãÊªì": [
        {n:"Á≠â‰æ°‰∫§Êèõ", e:"EXP„ÇíATK„Å∏"}, {n:"Âõ†Êûú„ÅÆÁ≥∏", e:"„ÉÄ„É°2ÂÄçÂèçËª¢"}, {n:"‰∏ñÁïå„ÅÆË®òÊÜ∂", e:"ÈÅ∫Áâ©ATK100%"}, {n:"ÁêÜ„ÅÆÊîπÂ§â", e:"„ÇØ„É™Á¢∫ÂÆö"}, {n:"Ê†πÊ∫ê„ÅÆÁêÜËß£", e:"ATK 100ÂÄç"},
        {n:"ËôöÊßã„ÅÆÂ¥©Â£ä", e:"Èò≤Âæ°ÁÑ°Ë¶ñ"}, {n:"Â§©„ÅÆÁß§", e:"„Éê„É©„É≥„ÇπË™øÊï¥"}, {n:"Áü•Ë≠ò„ÅÆÊøÄÊµÅ", e:"ÈÄüÂ∫¶10ÂÄç"}, {n:"ÈÅãÂëΩ„ÅÆÊñ≠ÁΩ™", e:"„ÉÄ„É°1000ÂÄç"}, {n:"Á•û„ÅÆÊï∞Âºè", e:"ÁúüÁêÜÂà∞ÈÅî"}
    ],
    "Á•ûË®ó„ÅÆÊÆãÈüø": [
        {n:"Á•à„Çä", e:"ÂÖ®ÂõûÂæ©"}, {n:"ËÅñ„Å™„ÇãÂÖâ", e:"ATK 4ÂÄç"}, {n:"Â§©‰Ωø„ÅÆÂä†Ë≠∑", e:"Ë¢´„ÉÄ„É°ÂçäÊ∏õ"}, {n:"Â•áË∑°„ÅÆ‰∫àÂÖÜ", e:"„Éâ„É≠„ÉÉ„ÉóÁéáUP"}, {n:"Â§©Âïì„ÅÆË™ø„Åπ", e:"ÂÖ®„Çπ„ÉÜ1.5ÂÄç"},
        {n:"ËÅñÂüü„ÅÆÁõæ", e:"Áä∂ÊÖãÁï∞Â∏∏ÁÑ°Âäπ"}, {n:"Á•û„ÅÆÂØ©Âà§", e:"ÂÖâ„ÉÄ„É°"}, {n:"Á¶èÈü≥„ÅÆÈüø„Åç", e:"ÂÜçËµ∑Êï∞√ó10ATK"}, {n:"Ëá≥Á¶è„ÅÆÊôÇ", e:"EXP 10ÂÄç"}, {n:"‰∏ª„ÅÆÂæ°Êâã", e:"Á•ûË®óÊàêÂ∞±"}
    ],
    "ËôöÁÑ°„ÅÆÊ∑±Ê∑µ": [
        {n:"ÂøòÂç¥", e:"ÊïµHP 5%Ââä„Çä"}, {n:"ÂΩ±„ÅÆÊµ∏È£ü", e:"ATK 7ÂÄç"}, {n:"ÊöóÈªí„ÅÆÂ∫ï", e:"ÈÄüÂ∫¶Ê∏õË°∞ÁÑ°Ë¶ñ"}, {n:"Á©∫Ëôö„Å™Â§¢", e:"„ÉÄ„É°ÁÑ°Âäπ"}, {n:"Â≠òÂú®„ÅÆÂê¶ÂÆö", e:"Ê∂àÊªÖ„ÉÄ„É°"},
        {n:"ÁÑ°„Å∏„ÅÆÈÇÑÂÖÉ", e:"ÂÖ®„Çπ„ÉÜ„É™„Çª„ÉÉ„Éà"}, {n:"Ê∑±Ê∑µ„ÅÆÁúº", e:"Âº±ÁÇπÁúãÁ†¥"}, {n:"ÁµÇÁÑâ„ÅÆ‰∫àË®Ä", e:"ÁßíÊÆ∫„Ç´„Ç¶„É≥„Éà"}, {n:"ÊªÖ„Å≥„ÅÆÊ≠å", e:"ATK 666ÂÄç"}, {n:"Áµ∂ÂØæÈõ∂", e:"ÂÆåÂÖ®ÈùôÊ≠¢"}
    ],
    "Ê©üÂ∑•„ÅÆÂøÉËáì": [
        {n:"Ê≠ØËªä„ÅÆÂõûËª¢", e:"ÈÄüÂ∫¶1.2ÂÄç"}, {n:"ÈÅéË≤†Ëç∑„ÅÆÁÜ±", e:"ATK 20ÂÄç"}, {n:"Á≤æÂØÜÊºîÁÆó", e:"„ÇØ„É™Áéá100%"}, {n:"ÈãºÈâÑ„ÅÆÊÑèÂøó", e:"HP 5ÂÄç"}, {n:"Ëá™Âãï‰øÆÂæ©", e:"ÊØéÁßíÂõûÂæ©"},
        {n:"Ëí∏Ê∞ó„ÅÆÂô¥ÈÄ≤", e:"„Éí„ÉÉ„Éà+8"}, {n:"Ê©üÂ∑•„ÅÆÈÄ£Èéñ", e:"ÈÄ£ÊíÉATKÂ¢ó"}, {n:"Ê¨°ÂÖÉ„ÅÆÊ≠ØËªä", e:"ÊôÇÈñìÊìç‰Ωú"}, {n:"Á•û„ÅÆË®≠Ë®àÂõ≥", e:"Âü∫Á§éATK10ÂÄç"}, {n:"Á©∂Ê•µ„ÅÆÊ©üÊßã", e:"Ê©üÂ∑•Á•ûÂåñ"}
    ]
};

let p, currentBossHP = BOSS_MAX_HP, longPressInterval = null;

function init() {
    const saved = localStorage.getItem(SAVE_KEY);
    p = saved ? JSON.parse(saved) : { lv: 1, exp: 0, inventory: {}, deathCount: 0 };
    if (!p.inventory) p.inventory = {};
    const btn = document.getElementById("attackBtn");
    const start = (e) => { e.preventDefault(); if(!longPressInterval){ battle(); longPressInterval = setInterval(battle, 100); } };
    const stop = () => { if(longPressInterval){ clearInterval(longPressInterval); longPressInterval = null; } };
    btn.addEventListener("touchstart", start); btn.addEventListener("touchend", stop);
    btn.addEventListener("mousedown", start); btn.addEventListener("mouseup", stop); btn.addEventListener("mouseleave", stop);
    refresh();
}

function calcStats() {
    const maxHP = p.lv * 100 + 10;
    let relicAtkBonus = 0;
    Object.keys(p.inventory).forEach(id => {
        const grade = id % 10;
        const count = p.inventory[id];
        relicAtkBonus += (100 * (grade + 1) * count);
    });

    let s = { 
        maxHP: maxHP,
        baseAtk: 10 + (p.lv * 5) + relicAtkBonus, 
        deathM: 1 + (p.deathCount * 0.001), 
        multi: 1, hits: 1 
    };
    
    // „Çπ„Ç≠„É´ÂäπÊûúÁ∞°ÊòìÂèçÊò†ÔºàÂâ£Á•û„ÅÆÂàùÊ≠©„ÅÆ„ÅøÔºâ
    if(getRelicCountByName("Ââ£Á•û„ÅÆÊÆãÁÅ´") >= STEPS[0]) s.multi *= 1.5;
    
    s.finalAtk = s.baseAtk * s.deathM * s.multi;
    return s;
}

function getRelicCountByName(name) {
    const sIdx = POWER_NAMES.indexOf(name);
    let count = 0;
    for(let i=0; i<10; i++) count += (p.inventory[sIdx * 10 + i] || 0);
    return count;
}

function battle() {
    const s = calcStats();
    currentBossHP -= s.finalAtk;
    if(currentBossHP < 0) currentBossHP = 0;

    p.deathCount++;
    p.exp += 10 + (p.lv * 2);

    if (Math.random() < 0.2) {
        const rid = Math.floor(Math.random() * 100);
        p.inventory[rid] = (p.inventory[rid] || 0) + 1;
        const sysName = POWER_NAMES[Math.floor(rid/10)].split("„ÅÆ")[0];
        addLog(`<span style="color:var(--gold)">üíé ${sysName}„ÅÆ${RELIC_GRADES[rid%10]} Áç≤Âæó</span>`);
    }

    const nextExp = p.lv * 50 + 100;
    while (p.exp >= nextExp) { p.exp -= nextExp; p.lv++; }
    refresh();
}

function refresh() {
    const s = calcStats();
    const nextExp = p.lv * 50 + 100;
    
    const bossPer = (currentBossHP / BOSS_MAX_HP * 100);
    document.getElementById("bosshp").style.width = bossPer + "%";
    document.getElementById("bosshp-text").innerText = bossPer.toFixed(6) + "%";
    document.getElementById("playerhp-text").innerText = `${Math.floor(s.maxHP)} / ${Math.floor(s.maxHP)}`;
    document.getElementById("playerhp").style.width = "100%";
    document.getElementById("exp-bar").style.width = (p.exp / nextExp * 100) + "%";
    document.getElementById("exp-text").innerText = Math.floor(p.exp / nextExp * 100) + "%";
    document.getElementById("p-lv-text").innerText = `Lv.${p.lv}`;
    document.getElementById("sum-atk").innerText = Math.floor(s.finalAtk).toLocaleString();

    if (document.activeTab === 'status') renderStatus(s);
    if (document.activeTab === 'power') renderPowers();
    if (document.activeTab === 'relic') renderRelics();
    
    localStorage.setItem(SAVE_KEY, JSON.stringify(p));
}

function renderStatus(s) {
    document.getElementById("statusList").innerHTML = `
        <div class="status-item"><span>ÊúÄÂ§ßHP</span><span>${Math.floor(s.maxHP)}</span></div>
        <div class="status-item"><span>Âü∫Á§éÊîªÊíÉÂäõ</span><span>${Math.floor(s.baseAtk)}</span></div>
        <div class="status-item"><span>ÂÜçËµ∑„ÅÆË™ì„ÅÑ</span><span>${p.deathCount} Âõû</span></div>
        <div class="status-item"><span>ÊúÄÁµÇÊîªÊíÉÂäõ</span><span>${Math.floor(s.finalAtk).toLocaleString()}</span></div>
    `;
}

function renderPowers() {
    document.getElementById("powerList").innerHTML = POWER_NAMES.map(name => {
        const count = getRelicCountByName(name);
        const skills = SKILL_MASTER[name];
        return `<div class="card-cell"><b>${name}</b> (ÈÅ∫Áâ©:${count})
            <div class="skill-list">${skills.map((sk, i) => {
                const isUnlocked = count >= STEPS[i];
                return `<div class="skill-item ${isUnlocked ? 'skill-unlocked' : ''}">${isUnlocked ? sk.n : '???'}<br><small>${isUnlocked ? sk.e : STEPS[i]+'ÂÄã„ÅßËß£Êîæ'}</small></div>`;
            }).join("")}</div>
        </div>`;
    }).join("");
}

function renderRelics() {
    const ids = Object.keys(p.inventory).filter(id => p.inventory[id] > 0).sort((a,b)=>a-b);
    document.getElementById("relicList").innerHTML = ids.length ? ids.map(id => {
        const typeIdx = Math.floor(id / 10);
        const gradeIdx = id % 10;
        const baseName = POWER_NAMES[typeIdx].split("„ÅÆ")[0];
        const effect = (100 * (gradeIdx + 1) * p.inventory[id]);
        return `<div class="card-cell">
            <div style="display:flex; justify-content:space-between;"><b>‚≠êÔ∏é${gradeIdx + 1} ${baseName}„ÅÆ${RELIC_GRADES[gradeIdx]}</b> <span>√ó${p.inventory[id]}</span></div>
            <div class="relic-effect">ÂäπÊûú: Âü∫Á§éATK +${effect}</div>
        </div>`;
    }).join("") : "<p style='text-align:center;'>ÈÅ∫Áâ©„ÅØÊú™Áô∫Ë¶ã</p>";
}

function showTab(id, btn) {
    document.activeTab = id;
    document.querySelectorAll(".tab").forEach(t => t.classList.remove("active"));
    document.getElementById(id).classList.add("active");
    document.querySelectorAll(".nav button").forEach(b => b.classList.remove("active"));
    btn.classList.add("active");
    refresh();
}

function addLog(m) {
    const l = document.getElementById("log");
    const d = document.createElement("div"); d.innerHTML = m;
    l.prepend(d); if (l.childNodes.length > 20) l.removeChild(l.lastChild);
}
init();
</script>
</body>
</html>

<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>RELICORE - v1.0</title>
<style>
/* スタイル関連コードは元のコードと変わらず省略 */
</style>
</head>
<body>
<!-- 省略されるHTMLの部分はそのままで修正がない場合です -->

<script>
const SAVE_KEY = "relicore_player_data";
const BOSS_MAX_HP_BASE = 100000000000000000000n;
const MAJIN_ATK_BASE = 999999999999n;
const BASE_DROP_DATA = { 1:{p:99.888889,cond:0n}, 2:{p:0.1,cond:0n}, 3:{p:0.01,cond:0n}, 4:{p:0.001,cond:100000n}, 5:{p:0.0001,cond:1000000n}, 6:{p:0.00001,cond:10000000n}, 7:{p:0.000001,cond:100000000n} };
const HADO_DROP_DATA = { 1:{p:78.988889,cond:0n}, 2:{p:20.0,cond:0n}, 3:{p:1.0,cond:0n}, 4:{p:0.001,cond:100000n}, 5:{p:0.0001,cond:1000000n}, 6:{p:0.00001,cond:10000000n}, 7:{p:0.000001,cond:100000000n} };
let player = { inventory: {0:1}, deathCount:0, baseAtk:10n, baseHP:100n, maxDmg:0n, storySeen:false, hasHado:false, isUra:false, bossMaxHP: BOSS_MAX_HP_BASE.toString(), uraAtkMult: "1" };
let currentBossHP = BigInt(player.bossMaxHP);
let attackInterval = null;
let isModalOpen = false;
const VOW_THRESHOLDS = [1000, 5000, 25000, 100000, 250000];
const REJECTION_THRESHOLDS = [3000, 15000, 60000, 150000];

/* 修正された RELIC_MASTER 配列 */
const RELIC_MASTER = [
  {id:0, star:8, name:"再起の誓い", atk:0, hp:0, desc:"不屈の魂に刻まれた、再誕の原点。"},
  /* ★2遺物 */
  {id:201, star:2, name:"聖騎士の欠片", atk:41.2, hp:682.4},
  {id:202, star:2, name:"龍騎士の欠片", atk:86.7, hp:423.1},
  {id:203, star:2, name:"暗黒騎士の欠片", atk:134.2, hp:0},
  {id:204, star:2, name:"賢者の欠片", atk:52.1, hp:711.2},
  /* 他の★2遺物を省略 */
  /* ★3遺物 */
  {id:301, star:3, name:"聖龍騎士の欠片", atk:874.3, hp:6924.1},
  {id:302, star:3, name:"深淵魔導の欠片", atk:1324.1, hp:214.7},
  {id:303, star:3, name:"金剛武神の欠片", atk:412.8, hp:14863.2},
  {id:304, star:3, name:"暗黒皇帝の欠片", atk:1568.4, hp:0},
  /* 他の★3遺物を省略 */
];

function renderRelics() {
  const container = document.getElementById("relic-list");
  if (!container) return;

  const sorted = Object.entries(player.inventory).filter(([id, c]) => c > 0).sort((a, b) => {
    const ra = RELIC_MASTER.find(x => x.id == a[0]);
    const rb = RELIC_MASTER.find(x => x.id == b[0]);
    return (ra && rb) ? ra.star - rb.star : 0;
  });

  container.innerHTML = sorted.map(([id, c]) => {
    const m = RELIC_MASTER.find(x => x.id == id);
    if (!m) return "";

    // 内部的な計算値
    let baseA = (m.atk || 0) * (player.hasHado && m.star === 1 ? 10 : 1);
    let baseH = (m.hp || 0) * (player.hasHado && m.star === 1 ? 10 : 1);

    // 表示用の整数値
    let displayA = Math.floor(baseA);
    let displayH = Math.floor(baseH);

    let stText = (displayA ? `ATK +${displayA} ` : "") + (displayH ? `HP +${displayH}` : "");

    return `
      <div class="relic-card">
        <div class="relic-name c${m.star}">★${m.star} ${m.name}×${c}</div>
        <div class="relic-effect-box">${m.desc ? m.desc : stText}</div>
      </div>`;
  }).join("");
}

function refreshUI() {
  /* ステータス更新用関数の更新 */
}

function attack() {
  /* 攻撃ロジック */
}

/* 他のスクリプト部分に変更はありません */
</script>
</body>
</html>